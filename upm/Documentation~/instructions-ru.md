# Инструкции по использованию

`TypeAnalyzer` — это инструмент для анализа структуры типов.
Он предоставляет возможность извлекать информацию о конструкторах, методах, свойствах и полях заданного типа.
Этот инструмент полезен при работе с рефлексией, когда требуется динамически исследовать типы во время выполнения.

## Как использовать

`TypeAnalyzer` используется для:

- Инспекции типов : Получение информации о структуре класса или структуры.
- Фильтрации данных : Выборочное извлечение только тех элементов типа, которые необходимы (например, только методы или только свойства).
- Кэширования результатов : Оптимизация производительности за счет кэширования результатов анализа.

### Анализ типа

Для анализа типа используйте метод Analyze интерфейса ITypeAnalyzer. Метод принимает два параметра:

- `type`: Тип, который нужно проанализировать.
- `options`: Опции, определяющие, какие элементы типа следует извлечь (конструкторы, методы, свойства, поля). По умолчанию используется `TypeAnalysisOptions.All`.

``` csharp
var analyzer = new TypeAnalyzer();
var result = analyzer.Analyze(typeof(MyClass), TypeAnalysisOptions.Methods | TypeAnalysisOptions.Properties);
```

В этом примере будут извлечены только методы и свойства типа `MyClass`.

### Использование опций

Опции `TypeAnalysisOptions` позволяют гибко настраивать анализ:

- `None`: Не извлекает никакие элементы типа.
- `Constructors`: Извлекает конструкторы типа.
- `Methods`: Извлекает методы типа.
- `Properties`: Извлекает свойства типа.
- `Fields`: Извлекает поля типа.
- `All`: Извлекает все элементы типа.

Если вам нужны только определенные элементы, комбинируйте опции с помощью оператора |:

``` csharp
var options = TypeAnalysisOptions.Constructors | TypeAnalysisOptions.Fields;
var result = analyzer.Analyze(typeof(MyClass), options);
```

### Работа с результатами

Результат анализа возвращается в виде объекта `TypeAnalysisResult`, который содержит коллекции:

- `Constructors`: Список конструкторов.
- `Methods`: Список методов.
- `Properties`: Список свойств.
- `Fields`: Список полей.

Эти коллекции можно использовать для дальнейшей обработки. Например:

``` csharp
if (result.Methods != null)
{
    foreach (var method in result.Methods)
    {
        Console.WriteLine($"Method: {method.Name}");
    }
}
```

**Важно:** Коллекции могут быть `null`, если соответствующая опция не была указана при анализе. Всегда проверяйте коллекции на `null` перед использованием.

### Кэширование

`TypeAnalyzer` автоматически кэширует результаты анализа для каждого типа.
Это позволяет избежать повторного анализа одного и того же типа, что повышает производительность.

Если вам нужно очистить кэш (например, при тестировании), используйте метод `ClearCache()`:

``` csharp
analyzer.ClearCache();
```

## Рекомендации

- Оптимизация производительности
  - Используйте минимальный набор опций, чтобы извлекать только те данные, которые действительно нужны.
  - Если вы работаете с одним и тем же типом несколько раз, полагайтесь на кэширование, чтобы избежать лишних вычислений.
- Обработка пустых типов
  - Если анализируемый тип не содержит элементов (например, пустой класс), соответствующие коллекции в `TypeAnalysisResult` будут пустыми (но не `null`, если соответствующая опция была указана). Убедитесь, что ваш код корректно обрабатывает такие случаи.
- Обработка коллекций
  - Коллекции в `TypeAnalysisResult` могут быть `null`, если соответствующая опция не была указана в опциях анализа. Всегда проверяйте коллекции на `null` перед использованием.
- Проверка входных данных
  - Перед вызовом метода `Analyze` убедитесь, что передаваемый тип не равен `null`. В противном случае будет выброшено исключение `RequireException`.
- Тестирование
  - Очищайте кэш перед каждым тестом, чтобы избежать влияния предыдущих запусков.
  - Проверяйте как положительные сценарии (тип с различными элементами), так и отрицательные (пустой тип, опция `None`).

## Пример использования

### Полный анализ типа

``` csharp
var analyzer = new TypeAnalyzer();
var result = analyzer.Analyze(typeof(MyClass), TypeAnalysisOptions.All);

Console.WriteLine("Constructors:");
foreach (var ctor in result.Constructors)
{
    Console.WriteLine(ctor.Name);
}

Console.WriteLine("Methods:");
foreach (var method in result.Methods)
{
    Console.WriteLine(method.Name);
}
```

### Выборочный анализ

``` csharp
var analyzer = new TypeAnalyzer();
var result = analyzer.Analyze(typeof(MyClass), TypeAnalysisOptions.Properties);

Console.WriteLine("Properties:");
foreach (var property in result.Properties)
{
    Console.WriteLine(property.Name);
}
```
